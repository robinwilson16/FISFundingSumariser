DECLARE @FISDatabase NVARCHAR(100) = 'FIS_1718_R14_F'
DECLARE @AcademicYear NVARCHAR(5) = '17/18'
DECLARE @ILRReturn int = 14
DECLARE @IsFinalReturn bit = 1
DECLARE @Split1619Funding bit = 1
DECLARE @1619ALSFundingPercent DECIMAL(3,2) = 0.07
DECLARE @FutureAchieveWeighting DECIMAL(3,2) = 1
DECLARE @Mode NCHAR(1) = 'I'
DECLARE @FISOutputTableLocation NVARCHAR(200) = 'ProSolutionReports.dbo.'
DECLARE @ProSolutionDatabaseLocation NVARCHAR(200) = 'ProSolution.dbo.'
DECLARE @ProAchieveDatabaseLocation NVARCHAR(200) = 'ussql01.ProGeneral.dbo.'
DECLARE @ProviderFieldFacLocation NCHAR(1) = 'B'
DECLARE @ProviderFieldTeamLocation NCHAR(1) = 'C'
DECLARE @ProviderFieldCostCentreLocation NCHAR(1) = 'C'
DECLARE @ProviderFieldCourseLocation NCHAR(1) = 'A'
DECLARE @ProviderFieldCourseFormat NVARCHAR(50) = 'CRS.Code + "-" + GRP.Code'
DECLARE @OverrideEngFac NVARCHAR(50) = 'F05'
DECLARE @OverrideMatFac NVARCHAR(50) = 'F05'
DECLARE @OverrideEngTeam NVARCHAR(50) = 'T01'
DECLARE @OverrideMatTeam NVARCHAR(50) = 'T02'
DECLARE @OverrideEngCostCentre NVARCHAR(50) = '4461'
DECLARE @OverrideMatCostCentre NVARCHAR(50) = '4462'
DECLARE @OverridePartnerFac NVARCHAR(50) = 'F00'
DECLARE @OverridePartnerTeam NVARCHAR(50) = 'T00'
DECLARE @OverridePartnerCostCentre NVARCHAR(50) = NULL

DECLARE @SQLString NVARCHAR(MAX);
DECLARE @SQLParams NVARCHAR(MAX);

SET @SQLString = N'
	EXEC SPR_FIS_GenerateFundingData
		@FISDatabase,
        @AcademicYear,
		@ILRReturn,
		@IsFinalReturn,
		@Split1619Funding,
        @1619ALSFundingPercent,
		@FutureAchieveWeighting,
		@Mode,
		@FISOutputTableLocation,
		@ProSolutionDatabaseLocation,
		@ProAchieveDatabaseLocation,
		@ProviderFieldFacLocation,
		@ProviderFieldTeamLocation,
		@ProviderFieldCostCentreLocation,
		@ProviderFieldCourseLocation,
		@ProviderFieldCourseFormat,
		@OverrideEngFac,
		@OverrideMatFac,
		@OverrideEngTeam,
		@OverrideMatTeam,
		@OverrideEngCostCentre,
		@OverrideMatCostCentre,
		@OverridePartnerFac,
		@OverridePartnerTeam,
		@OverridePartnerCostCentre';

SET @SQLParams = 
        N'@FISDatabase NVARCHAR(100),
        @AcademicYear NVARCHAR(5),
        @ILRReturn int,
        @IsFinalReturn bit,
        @Split1619Funding bit,
        @1619ALSFundingPercent DECIMAL(3,2),
        @FutureAchieveWeighting DECIMAL(3,2),
        @Mode NCHAR(1),
        @FISOutputTableLocation NVARCHAR(200),
        @ProSolutionDatabaseLocation NVARCHAR(200),
        @ProAchieveDatabaseLocation NVARCHAR(200),
        @ProviderFieldFacLocation NCHAR(1),
		@ProviderFieldTeamLocation NCHAR(1),
		@ProviderFieldCostCentreLocation NCHAR(1),
		@ProviderFieldCourseLocation NCHAR(1),
        @ProviderFieldCourseFormat NVARCHAR(50),
        @OverrideEngFac NVARCHAR(50),
        @OverrideMatFac NVARCHAR(50),
        @OverrideEngTeam NVARCHAR(50),
        @OverrideMatTeam NVARCHAR(50),
        @OverrideEngCostCentre NVARCHAR(50),
        @OverrideMatCostCentre NVARCHAR(50),
        @OverridePartnerFac NVARCHAR(50),
        @OverridePartnerTeam NVARCHAR(50),
        @OverridePartnerCostCentre NVARCHAR(50)';
    
EXECUTE sp_executesql 
    @SQLString, 
    @SQLParams, 
    @FISDatabase = @FISDatabase,
    @AcademicYear = @AcademicYear,
    @ILRReturn = @ILRReturn,
    @IsFinalReturn = @IsFinalReturn,
    @Split1619Funding = @Split1619Funding,
    @1619ALSFundingPercent = @1619ALSFundingPercent,
    @FutureAchieveWeighting = @FutureAchieveWeighting,
    @Mode = @Mode,
    @FISOutputTableLocation = @FISOutputTableLocation,
    @ProSolutionDatabaseLocation = @ProSolutionDatabaseLocation,
    @ProAchieveDatabaseLocation = @ProAchieveDatabaseLocation,
    @ProviderFieldFacLocation = @ProviderFieldFacLocation,
	@ProviderFieldTeamLocation = @ProviderFieldTeamLocation,
	@ProviderFieldCostCentreLocation = @ProviderFieldCostCentreLocation,
	@ProviderFieldCourseLocation = @ProviderFieldCourseLocation,
    @ProviderFieldCourseFormat = @ProviderFieldCourseFormat,
    @OverrideEngFac = @OverrideEngFac,
    @OverrideMatFac = @OverrideMatFac,
    @OverrideEngTeam = @OverrideEngTeam,
    @OverrideMatTeam = @OverrideMatTeam,
    @OverrideEngCostCentre = @OverrideEngCostCentre,
    @OverrideMatCostCentre = @OverrideMatCostCentre,
    @OverridePartnerFac = @OverridePartnerFac,
    @OverridePartnerTeam = @OverridePartnerTeam,
    @OverridePartnerCostCentre = @OverridePartnerCostCentre;